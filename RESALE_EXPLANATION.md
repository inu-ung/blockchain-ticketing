# 재판매, 마켓플레이스, 토큰 개념 설명

## 1. 토큰(Token)이란?

### 기본 개념
NFT 티켓 시스템에서 **"토큰"**은 각 티켓을 고유하게 식별하는 번호입니다.

### 예시
```
이벤트 A의 첫 번째 티켓 → token_id: 1
이벤트 A의 두 번째 티켓 → token_id: 2
이벤트 B의 첫 번째 티켓 → token_id: 3
```

### 특징
- ✅ **고유성**: 각 티켓마다 고유한 번호
- ✅ **위조 불가능**: 블록체인에 저장되어 변경 불가
- ✅ **소유권 추적**: 각 토큰은 고유한 소유자(지갑 주소)를 가짐
- ✅ **전송 가능**: 다른 사람에게 전송 가능

### 실제 사용 예시
```
티켓 구매 시:
- 이벤트 ID: 1
- 구매자: 0x1234...
- 발행된 토큰 ID: 5
→ "이벤트 1의 5번 티켓을 0x1234...가 소유"
```

---

## 2. 마켓플레이스(Marketplace)란?

### 기본 개념
**마켓플레이스**는 구매한 티켓을 다른 사람에게 다시 판매할 수 있는 2차 시장 플랫폼입니다.

### 작동 방식

#### 1단계: 재판매 등록
```
내가 구매한 티켓 (token_id: 5)
→ 마켓플레이스에 1.5 MATIC에 등록
```

#### 2단계: 구매자 찾기
```
다른 사람이 마켓플레이스에서 티켓 확인
→ 1.5 MATIC에 구매 결정
```

#### 3단계: 거래 완료
```
- 구매자가 1.5 MATIC 지불
- 티켓 소유권이 구매자로 이전
- 나는 1.5 MATIC 받음
```

### 특징
- ✅ **가격 자유 설정**: 원하는 가격에 판매 가능 (최대 200%까지)
- ✅ **자동 거래**: 스마트 컨트랙트가 자동으로 처리
- ✅ **수수료**: 거래 시 중개 수수료 발생 (5-10%)
- ✅ **투명성**: 모든 거래가 블록체인에 기록됨

### 예시 시나리오
```
1. 내가 콘서트 티켓을 1 MATIC에 구매 (token_id: 5)
2. 콘서트가 인기 많아져서 티켓 가격이 올라감
3. 마켓플레이스에 1.5 MATIC에 재판매 등록
4. 다른 사람이 1.5 MATIC에 구매
5. 나는 1.5 MATIC 받고, 티켓 소유권은 구매자로 이전
```

---

## 3. 재판매 등록 방법

### 현재 상태
프론트엔드의 "내 티켓" 페이지에는 재판매 버튼이 **아직 없습니다**.

### 재판매 등록 방법 (2가지)

#### 방법 1: API로 직접 호출 (현재 가능)

**브라우저 콘솔에서 실행:**
```javascript
// 1. 내 티켓 목록 가져오기
const tickets = await fetch('http://localhost:8000/api/v1/tickets', {
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('token')}`
  }
}).then(r => r.json());

console.log('내 티켓:', tickets);

// 2. 첫 번째 티켓을 재판매 등록
const ticketId = tickets[0].id;
const priceWei = '1500000000000000000'; // 1.5 MATIC (wei 단위)

const response = await fetch('http://localhost:8000/api/v1/resales', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${localStorage.getItem('token')}`
  },
  body: JSON.stringify({
    ticket_id: ticketId,
    price_wei: priceWei
  })
});

const result = await response.json();
console.log('재판매 등록 결과:', result);
```

#### 방법 2: 프론트엔드에 버튼 추가 (권장)

"내 티켓" 페이지에 재판매 버튼을 추가하면 더 편리합니다.

---

## 4. 전체 플로우

### 티켓 구매 → 재판매 → 구매 플로우

```
1. [구매자 A] 이벤트에서 티켓 구매
   → token_id: 5 발행
   → 소유자: 0xAAAA... (구매자 A의 Smart Wallet)

2. [구매자 A] 마켓플레이스에 재판매 등록
   → 가격: 1.5 MATIC
   → 상태: LISTED (판매 중)

3. [구매자 B] 마켓플레이스에서 티켓 확인
   → token_id: 5, 가격: 1.5 MATIC

4. [구매자 B] 재판매 티켓 구매
   → 1.5 MATIC 지불
   → 소유자: 0xBBBB... (구매자 B의 Smart Wallet)
   → 상태: SOLD (판매 완료)

5. [구매자 A] 1.5 MATIC 받음
```

---

## 5. 마켓플레이스 페이지 기능

### 현재 기능
- ✅ 재판매 중인 티켓 목록 표시
- ✅ 티켓 정보 확인 (이벤트, 가격, 등록일)
- ✅ 재판매 티켓 구매

### 표시 정보
- 티켓 번호 (token_id)
- 이벤트 이름
- 판매 가격
- 등록일
- 구매하기 버튼

---

## 6. 재판매 규칙

### 가격 제한
- 최대 가격: 원래 가격의 **200%**까지
- 예: 1 MATIC에 구매한 티켓 → 최대 2 MATIC까지 판매 가능

### 조건
- ✅ 티켓 소유자만 재판매 등록 가능
- ✅ 이미 등록된 티켓은 중복 등록 불가
- ✅ 판매 중인 티켓만 구매 가능

---

## 7. 테스트 방법

### 재판매 등록 테스트
1. 티켓 구매 (이미 완료)
2. 브라우저 콘솔에서 API 호출로 재판매 등록
3. 마켓플레이스 페이지에서 확인

### 재판매 구매 테스트
1. 다른 계정으로 로그인
2. 마켓플레이스에서 티켓 확인
3. "구매하기" 버튼 클릭

---

## 다음 단계

재판매 기능을 더 편리하게 사용하려면:
1. "내 티켓" 페이지에 재판매 버튼 추가
2. 재판매 등록 모달 추가
3. 가격 입력 및 확인 기능

원하시면 프론트엔드에 재판매 버튼을 추가해드릴 수 있습니다!

