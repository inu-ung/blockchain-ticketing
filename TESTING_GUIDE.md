# 테스트 가이드

## 🚀 빠른 시작

### 1. 백엔드 서버 실행

```bash
cd backend
source venv/bin/activate
uvicorn main:app --reload
```

서버가 실행되면:
- API 서버: http://localhost:8000
- API 문서: http://localhost:8000/docs

### 2. 프론트엔드 서버 실행

새 터미널 창에서:

```bash
cd frontend
npm run dev
```

프론트엔드가 실행되면:
- 웹 앱: http://localhost:5173 (또는 Vite가 표시하는 주소)

---

## 📋 테스트 시나리오

### 시나리오 1: 회원가입 및 로그인

1. **회원가입**
   - http://localhost:5173 접속
   - "회원가입" 클릭
   - 이메일: `test@example.com`
   - 비밀번호: `test123`
   - 역할: 구매자 선택
   - "회원가입" 버튼 클릭
   - ✅ 성공 메시지 확인

2. **로그인**
   - "로그인" 클릭
   - 이메일/비밀번호 입력
   - "로그인" 버튼 클릭
   - ✅ 상단 네비게이션에 이메일 표시 확인

### 시나리오 2: 주최자 계정 생성

1. **주최자 회원가입**
   - 로그아웃
   - 회원가입
   - 역할: 주최자 선택
   - 이메일: `organizer@example.com`
   - ✅ "이벤트 생성" 메뉴가 보이는지 확인

### 시나리오 3: 이벤트 생성 및 승인

1. **이벤트 생성** (주최자로 로그인)
   - "이벤트 생성" 클릭
   - 이벤트 정보 입력:
     - 이름: "테스트 콘서트"
     - 설명: "블록체인 티켓팅 테스트"
     - 가격: 0.1 (MATIC)
     - 최대 티켓: 100
     - 판매 시작/종료 시간 설정
     - 이벤트 날짜 설정
   - "이벤트 생성" 클릭
   - ✅ 성공 메시지 확인

2. **이벤트 승인** (관리자 계정 필요)
   - 관리자 계정으로 로그인 (또는 DB에서 직접 role 변경)
   - "관리자" 메뉴 클릭
   - 승인 대기 이벤트 확인
   - "승인하기" 클릭
   - ✅ 이벤트 상태가 "승인됨"으로 변경

### 시나리오 4: 티켓 구매

1. **이벤트 탐색**
   - "이벤트" 메뉴 클릭
   - 승인된 이벤트 목록 확인
   - 이벤트 카드 클릭

2. **티켓 구매**
   - 이벤트 상세 페이지에서
   - "티켓 구매하기" 버튼 클릭
   - ✅ 구매 성공 메시지 확인
   - "내 티켓" 메뉴에서 구매한 티켓 확인

### 시나리오 5: 재판매

1. **재판매 등록**
   - "내 티켓" 메뉴 클릭
   - 티켓 카드에서 "재판매 등록" 클릭
   - 가격 입력 (원가의 200% 이하)
   - 등록 완료

2. **재판매 구매**
   - "마켓플레이스" 메뉴 클릭
   - 재판매 티켓 목록 확인
   - "구매하기" 클릭
   - ✅ 구매 성공 확인

### 시나리오 6: 환불

1. **환불 요청**
   - "내 티켓" 메뉴에서 티켓 선택
   - 환불 요청 (API 직접 호출 또는 UI 추가 필요)
   - ✅ 환불 요청 확인

---

## 🧪 API 테스트 (Swagger UI)

### 접속
http://localhost:8000/docs

### 테스트 순서

1. **인증 토큰 받기**
   - `/api/v1/auth/login` 엔드포인트
   - "Try it out" 클릭
   - 이메일/비밀번호 입력
   - "Execute" 클릭
   - `access_token` 복사

2. **인증 설정**
   - 페이지 상단 "Authorize" 버튼 클릭
   - `Bearer {access_token}` 형식으로 입력
   - "Authorize" 클릭

3. **API 테스트**
   - 각 엔드포인트에서 "Try it out" 클릭
   - 파라미터 입력
   - "Execute" 클릭
   - 응답 확인

---

## 🔍 수동 테스트 체크리스트

### 인증
- [ ] 회원가입 (구매자)
- [ ] 회원가입 (주최자)
- [ ] 로그인
- [ ] 로그아웃
- [ ] 토큰 만료 시 자동 로그아웃

### 이벤트
- [ ] 이벤트 목록 조회
- [ ] 이벤트 필터링 (전체/승인됨/판매 중)
- [ ] 이벤트 상세 조회
- [ ] 이벤트 생성 (주최자)
- [ ] 이벤트 수정 (주최자)
- [ ] 이벤트 승인 (관리자)
- [ ] 이벤트 취소

### 티켓
- [ ] 티켓 구매
- [ ] 내 티켓 목록 조회
- [ ] 티켓 상세 조회
- [ ] 티켓 메타데이터 조회

### 재판매
- [ ] 재판매 목록 조회
- [ ] 재판매 등록
- [ ] 재판매 구매
- [ ] 재판매 취소
- [ ] 가격 상한선 검증

### 환불
- [ ] 환불 요청
- [ ] 환불 목록 조회
- [ ] 환불 승인 (주최자/관리자)
- [ ] 환불 거부

### 관리자
- [ ] 시스템 통계 조회
- [ ] 승인 대기 이벤트 조회
- [ ] 사용자 역할 변경

---

## 🐛 문제 해결

### 백엔드 서버가 시작되지 않음
```bash
# 가상환경 활성화 확인
source venv/bin/activate

# 패키지 재설치
pip install -r requirements.txt

# 포트 확인
lsof -i :8000
```

### 프론트엔드 빌드 오류
```bash
# node_modules 재설치
rm -rf node_modules package-lock.json
npm install

# 타입 체크
npm run build
```

### 데이터베이스 오류
```bash
# SQLite 파일 삭제 후 재생성
rm backend/ticketing.db
cd backend
source venv/bin/activate
python -c "from app.models import Base; from app.db.database import engine; Base.metadata.create_all(bind=engine)"
```

### API 연결 오류
- 백엔드 서버가 실행 중인지 확인
- CORS 설정 확인
- 프론트엔드 `.env` 파일의 `VITE_API_URL` 확인

---

## 📊 테스트 데이터

### 샘플 사용자
- 구매자: `buyer@test.com` / `test123`
- 주최자: `organizer@test.com` / `test123`
- 관리자: DB에서 직접 role 변경 필요

### 샘플 이벤트
- 이름: "2024 블록체인 콘서트"
- 가격: 0.1 MATIC
- 최대 티켓: 100장
- 판매 기간: 현재 시간 기준 설정

---

## 🔗 유용한 링크

- **API 문서**: http://localhost:8000/docs
- **프론트엔드**: http://localhost:5173
- **백엔드 Health**: http://localhost:8000/health

---

## 💡 팁

1. **두 개의 터미널 사용**
   - 터미널 1: 백엔드 서버
   - 터미널 2: 프론트엔드 서버

2. **브라우저 개발자 도구 활용**
   - Network 탭: API 요청 확인
   - Console 탭: 에러 확인
   - Application 탭: 로컬 스토리지 확인

3. **Swagger UI 활용**
   - API 테스트 및 문서 확인
   - 요청/응답 형식 확인

