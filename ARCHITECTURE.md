# ë¸”ë¡ì²´ì¸ í‹°ì¼“íŒ… ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

## ğŸ“‹ ëª©ì°¨
1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
3. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
4. [ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ êµ¬ì¡°](#ìŠ¤ë§ˆíŠ¸-ì»¨íŠ¸ë™íŠ¸-êµ¬ì¡°)
5. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
6. [API ì„¤ê³„](#api-ì„¤ê³„)
7. [í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°](#í”„ë¡ íŠ¸ì—”ë“œ-êµ¬ì¡°)
8. [Account Abstraction êµ¬í˜„](#account-abstraction-êµ¬í˜„)
9. [IPFS í†µí•©](#ipfs-í†µí•©)
10. [ë³´ì•ˆ ê³ ë ¤ì‚¬í•­](#ë³´ì•ˆ-ê³ ë ¤ì‚¬í•­)
11. [ë°°í¬ ì „ëµ](#ë°°í¬-ì „ëµ)

---

## ì‹œìŠ¤í…œ ê°œìš”

### ëª©ì 
ë¸”ë¡ì²´ì¸ ê¸°ë°˜ í‹°ì¼“íŒ… ì‹œìŠ¤í…œìœ¼ë¡œ ìœ„ì¡° ë°©ì§€, íˆ¬ëª…í•œ ì¬íŒë§¤ ì¶”ì , ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ê¸°ë°˜ ìë™í™”ëœ í™˜ë¶ˆ/ì·¨ì†Œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥
- âœ… ì´ë²¤íŠ¸ ìƒì„± ë° ê´€ë¦¬ (ì£¼ìµœì)
- âœ… NFT í‹°ì¼“ ë°œí–‰ ë° íŒë§¤
- âœ… í‹°ì¼“ êµ¬ë§¤ (ê³ ì •ê°€)
- âœ… 2ì°¨ ì‹œì¥ ì¬íŒë§¤
- âœ… í™˜ë¶ˆ ë° ì·¨ì†Œ ì²˜ë¦¬
- âœ… KYC (ê°„ë‹¨í•œ ì´ë©”ì¼ ì¸ì¦)
- âœ… Account Abstraction ê¸°ë°˜ ìë™ ì§€ê°‘ ì—°ê²°
- âœ… IPFS ê¸°ë°˜ ë©”íƒ€ë°ì´í„° ì €ì¥

### ì‚¬ìš©ì ì—­í• 
1. **ê´€ë¦¬ì**: ì‹œìŠ¤í…œ ì „ì²´ ê´€ë¦¬, ì´ë²¤íŠ¸ ìŠ¹ì¸, ê¸´ê¸‰ í™˜ë¶ˆ
2. **ì£¼ìµœì**: ì´ë²¤íŠ¸ ìƒì„±, í‹°ì¼“ ê°€ê²© ì„¤ì •, í™˜ë¶ˆ ì •ì±… ì„¤ì •
3. **êµ¬ë§¤ì**: í‹°ì¼“ êµ¬ë§¤, ì¬íŒë§¤, í™˜ë¶ˆ ìš”ì²­

---

## ê¸°ìˆ  ìŠ¤íƒ

### ë¸”ë¡ì²´ì¸
- **ë„¤íŠ¸ì›Œí¬**: Polygon (Mumbai í…ŒìŠ¤íŠ¸ë„· â†’ Polygon Mainnet)
- **ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì–¸ì–´**: Solidity (^0.8.20)
- **ê°œë°œ í”„ë ˆì„ì›Œí¬**: Hardhat
- **NFT í‘œì¤€**: ERC-721
- **Account Abstraction**: ERC-4337

### ë°±ì—”ë“œ
- **í”„ë ˆì„ì›Œí¬**: FastAPI (Python 3.11+)
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL 15+
- **ORM**: SQLAlchemy
- **ì¸ì¦**: JWT + OAuth2 (Google)
- **IPFS í´ë¼ì´ì–¸íŠ¸**: Pinata SDK

### í”„ë¡ íŠ¸ì—”ë“œ
- **í”„ë ˆì„ì›Œí¬**: React 18+ (TypeScript)
- **ìƒíƒœ ê´€ë¦¬**: Zustand / Redux Toolkit
- **UI ë¼ì´ë¸ŒëŸ¬ë¦¬**: Tailwind CSS + shadcn/ui
- **Web3 ë¼ì´ë¸ŒëŸ¬ë¦¬**: ethers.js / viem
- **Account Abstraction**: @account-abstraction/sdk

### ì¸í”„ë¼
- **IPFS**: Pinata
- **Account Abstraction Bundler**: Alchemy / Stackup
- **Paymaster**: ìì²´ êµ¬í˜„ ë˜ëŠ” Pimlico
- **ë°°í¬**: Docker + Docker Compose

---

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Frontend (React)                      â”‚
â”‚  - ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤                                         â”‚
â”‚  - ì§€ê°‘ ì—°ê²° (Account Abstraction)                          â”‚
â”‚  - ì´ë²¤íŠ¸ ë¸Œë¼ìš°ì§•/ê²€ìƒ‰                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTPS/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Backend (FastAPI)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Auth Service â”‚  â”‚ Event Serviceâ”‚  â”‚ Ticket Serviceâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ IPFS Service â”‚  â”‚ Web3 Service â”‚  â”‚ Payment Serviceâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚          â”‚              â”‚              â”‚
       â”‚          â”‚              â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL  â”‚ â”‚   IPFS     â”‚ â”‚  Polygon   â”‚ â”‚  Bundler   â”‚
â”‚  Database   â”‚ â”‚  (Pinata)  â”‚ â”‚ Blockchain â”‚ â”‚  (ERC-4337)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° íë¦„

1. **ì´ë²¤íŠ¸ ìƒì„±**
   - ì£¼ìµœìê°€ ì´ë²¤íŠ¸ ì •ë³´ ì…ë ¥
   - ë°±ì—”ë“œê°€ ë©”íƒ€ë°ì´í„°ë¥¼ IPFSì— ì—…ë¡œë“œ
   - ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì— ì´ë²¤íŠ¸ ë“±ë¡ (IPFS í•´ì‹œ í¬í•¨)
   - ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸°

2. **í‹°ì¼“ êµ¬ë§¤**
   - ì‚¬ìš©ìê°€ í‹°ì¼“ ì„ íƒ
   - Account Abstractionìœ¼ë¡œ ìë™ ì§€ê°‘ ìƒì„±/ì—°ê²°
   - ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ í˜¸ì¶œ (Paymasterê°€ ê°€ìŠ¤ë¹„ ë¶€ë‹´)
   - NFT í‹°ì¼“ ë°œí–‰
   - DBì— ê±°ë˜ ê¸°ë¡ ì €ì¥

3. **ì¬íŒë§¤**
   - ì‚¬ìš©ìê°€ ì¬íŒë§¤ ë“±ë¡
   - ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì— ë§ˆì¼“í”Œë ˆì´ìŠ¤ ë“±ë¡
   - êµ¬ë§¤ìê°€ êµ¬ë§¤ ì‹œ ìˆ˜ìˆ˜ë£Œ ìë™ ë¶„ë°°
   - DBì— ì¬íŒë§¤ ê¸°ë¡ ì—…ë°ì´íŠ¸

---

## ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ êµ¬ì¡°

### ì»¨íŠ¸ë™íŠ¸ ëª¨ë“ˆí™”

```
contracts/
â”œâ”€â”€ TicketNFT.sol              # ERC-721 í‹°ì¼“ NFT
â”œâ”€â”€ EventManager.sol           # ì´ë²¤íŠ¸ ê´€ë¦¬
â”œâ”€â”€ TicketMarketplace.sol      # 2ì°¨ ì‹œì¥ ì¬íŒë§¤
â”œâ”€â”€ RefundManager.sol          # í™˜ë¶ˆ ê´€ë¦¬
â”œâ”€â”€ AccessControl.sol           # ê¶Œí•œ ê´€ë¦¬ (ê´€ë¦¬ì/ì£¼ìµœì)
â””â”€â”€ interfaces/
    â”œâ”€â”€ ITicketNFT.sol
    â”œâ”€â”€ IEventManager.sol
    â””â”€â”€ IMarketplace.sol
```

### ì£¼ìš” ì»¨íŠ¸ë™íŠ¸

#### 1. TicketNFT.sol (ERC-721)
- í‹°ì¼“ NFT ë°œí–‰
- í‹°ì¼“ ì†Œìœ ê¶Œ ê´€ë¦¬
- í‹°ì¼“ ë©”íƒ€ë°ì´í„° (IPFS í•´ì‹œ)

#### 2. EventManager.sol
- ì´ë²¤íŠ¸ ìƒì„±/ìˆ˜ì •/ì‚­ì œ
- ì´ë²¤íŠ¸ ìŠ¹ì¸ (ê´€ë¦¬ì)
- í‹°ì¼“ ê°€ê²© ì„¤ì •
- í‹°ì¼“ ìˆ˜ëŸ‰ ê´€ë¦¬

#### 3. TicketMarketplace.sol
- ì¬íŒë§¤ ë“±ë¡
- ì¬íŒë§¤ êµ¬ë§¤
- ìˆ˜ìˆ˜ë£Œ ìë™ ë¶„ë°° (5-10%)
- ê°€ê²© ìƒí•œì„  ê²€ì¦ (200%)

#### 4. RefundManager.sol
- í™˜ë¶ˆ ìš”ì²­ ì²˜ë¦¬
- í™˜ë¶ˆ ì •ì±… ê²€ì¦
- ìë™ í™˜ë¶ˆ ì‹¤í–‰

#### 5. AccessControl.sol
- ê´€ë¦¬ì ê¶Œí•œ ê´€ë¦¬
- ì£¼ìµœì ê¶Œí•œ ê´€ë¦¬
- ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´

### ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì£¼ìš” í•¨ìˆ˜

```solidity
// EventManager.sol
function createEvent(
    string memory ipfsHash,
    uint256 price,
    uint256 maxTickets,
    uint256 startTime,
    uint256 endTime
) external returns (uint256 eventId);

function approveEvent(uint256 eventId) external onlyAdmin;
function updateEventPrice(uint256 eventId, uint256 newPrice) external onlyEventOwner;

// TicketNFT.sol
function mintTicket(
    address to,
    uint256 eventId,
    string memory tokenURI
) external returns (uint256 tokenId);

// TicketMarketplace.sol
function listTicketForResale(
    uint256 tokenId,
    uint256 price
) external;

function buyResaleTicket(uint256 tokenId) external payable;

// RefundManager.sol
function requestRefund(uint256 tokenId) external;
function processRefund(uint256 tokenId) external;
```

---

## ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### PostgreSQL í…Œì´ë¸” êµ¬ì¡°

```sql
-- ì‚¬ìš©ì í…Œì´ë¸”
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    wallet_address VARCHAR(42) UNIQUE,
    smart_wallet_address VARCHAR(42), -- Account Abstraction ì§€ê°‘
    role VARCHAR(20) DEFAULT 'buyer', -- admin, organizer, buyer
    kyc_verified BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ì´ë²¤íŠ¸ í…Œì´ë¸”
CREATE TABLE events (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    event_id_onchain BIGINT, -- ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì˜ eventId
    organizer_id UUID REFERENCES users(id),
    name VARCHAR(255) NOT NULL,
    description TEXT,
    ipfs_hash VARCHAR(255), -- IPFS ë©”íƒ€ë°ì´í„° í•´ì‹œ
    price_wei BIGINT NOT NULL, -- í‹°ì¼“ ê°€ê²© (wei)
    max_tickets INTEGER NOT NULL,
    sold_tickets INTEGER DEFAULT 0,
    start_time TIMESTAMP NOT NULL,
    end_time TIMESTAMP NOT NULL,
    event_date TIMESTAMP NOT NULL,
    status VARCHAR(20) DEFAULT 'pending', -- pending, approved, active, cancelled, ended
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- í‹°ì¼“ í…Œì´ë¸”
CREATE TABLE tickets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    token_id BIGINT UNIQUE NOT NULL, -- NFT tokenId
    event_id UUID REFERENCES events(id),
    owner_address VARCHAR(42) NOT NULL,
    ipfs_hash VARCHAR(255), -- í‹°ì¼“ ë©”íƒ€ë°ì´í„° IPFS í•´ì‹œ
    status VARCHAR(20) DEFAULT 'active', -- active, refunded, transferred, cancelled
    purchase_price_wei BIGINT,
    purchase_tx_hash VARCHAR(66),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ì¬íŒë§¤ í…Œì´ë¸”
CREATE TABLE resales (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    ticket_id UUID REFERENCES tickets(id),
    token_id BIGINT NOT NULL,
    seller_address VARCHAR(42) NOT NULL,
    price_wei BIGINT NOT NULL,
    status VARCHAR(20) DEFAULT 'listed', -- listed, sold, cancelled
    created_at TIMESTAMP DEFAULT NOW(),
    sold_at TIMESTAMP,
    sale_tx_hash VARCHAR(66)
);

-- ê±°ë˜ ë‚´ì—­ í…Œì´ë¸”
CREATE TABLE transactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tx_hash VARCHAR(66) UNIQUE NOT NULL,
    user_id UUID REFERENCES users(id),
    ticket_id UUID REFERENCES tickets(id),
    event_id UUID REFERENCES events(id),
    transaction_type VARCHAR(20) NOT NULL, -- purchase, resale, refund
    amount_wei BIGINT,
    gas_fee_wei BIGINT,
    status VARCHAR(20) DEFAULT 'pending', -- pending, confirmed, failed
    block_number BIGINT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- í™˜ë¶ˆ ìš”ì²­ í…Œì´ë¸”
CREATE TABLE refund_requests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    ticket_id UUID REFERENCES tickets(id),
    user_id UUID REFERENCES users(id),
    reason TEXT,
    status VARCHAR(20) DEFAULT 'pending', -- pending, approved, rejected, processed
    refund_amount_wei BIGINT,
    refund_tx_hash VARCHAR(66),
    created_at TIMESTAMP DEFAULT NOW(),
    processed_at TIMESTAMP
);
```

---

## API ì„¤ê³„

### ì¸ì¦ API

```
POST   /api/auth/register              # íšŒì›ê°€ì…
POST   /api/auth/login                 # ë¡œê·¸ì¸ (ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸)
POST   /api/auth/google                # Google ì†Œì…œ ë¡œê·¸ì¸
POST   /api/auth/logout                # ë¡œê·¸ì•„ì›ƒ
GET    /api/auth/me                    # í˜„ì¬ ì‚¬ìš©ì ì •ë³´
POST   /api/auth/wallet/connect        # ì§€ê°‘ ì—°ê²° (Account Abstraction)
```

### ì´ë²¤íŠ¸ API

```
GET    /api/events                     # ì´ë²¤íŠ¸ ëª©ë¡ (ê²€ìƒ‰/í•„í„°ë§)
GET    /api/events/:id                 # ì´ë²¤íŠ¸ ìƒì„¸
POST   /api/events                     # ì´ë²¤íŠ¸ ìƒì„± (ì£¼ìµœì)
PUT    /api/events/:id                 # ì´ë²¤íŠ¸ ìˆ˜ì • (ì£¼ìµœì)
DELETE /api/events/:id                 # ì´ë²¤íŠ¸ ì‚­ì œ (ì£¼ìµœì)
POST   /api/events/:id/approve         # ì´ë²¤íŠ¸ ìŠ¹ì¸ (ê´€ë¦¬ì)
POST   /api/events/:id/cancel          # ì´ë²¤íŠ¸ ì·¨ì†Œ (ì£¼ìµœì/ê´€ë¦¬ì)
```

### í‹°ì¼“ API

```
GET    /api/tickets                    # ë‚´ í‹°ì¼“ ëª©ë¡
GET    /api/tickets/:id                # í‹°ì¼“ ìƒì„¸
POST   /api/tickets/purchase           # í‹°ì¼“ êµ¬ë§¤
GET    /api/tickets/:id/metadata       # í‹°ì¼“ ë©”íƒ€ë°ì´í„° (IPFS)
```

### ì¬íŒë§¤ API

```
GET    /api/resales                    # ì¬íŒë§¤ ëª©ë¡
GET    /api/resales/:id                # ì¬íŒë§¤ ìƒì„¸
POST   /api/resales                    # ì¬íŒë§¤ ë“±ë¡
POST   /api/resales/:id/buy            # ì¬íŒë§¤ êµ¬ë§¤
DELETE /api/resales/:id                # ì¬íŒë§¤ ì·¨ì†Œ
```

### í™˜ë¶ˆ API

```
POST   /api/refunds/request            # í™˜ë¶ˆ ìš”ì²­
GET    /api/refunds                    # í™˜ë¶ˆ ìš”ì²­ ëª©ë¡
GET    /api/refunds/:id                # í™˜ë¶ˆ ìš”ì²­ ìƒì„¸
POST   /api/refunds/:id/approve        # í™˜ë¶ˆ ìŠ¹ì¸ (ê´€ë¦¬ì/ì£¼ìµœì)
POST   /api/refunds/:id/reject         # í™˜ë¶ˆ ê±°ë¶€
```

### ê´€ë¦¬ì API

```
GET    /api/admin/events/pending       # ìŠ¹ì¸ ëŒ€ê¸° ì´ë²¤íŠ¸
GET    /api/admin/stats                # ì‹œìŠ¤í…œ í†µê³„
POST   /api/admin/users/:id/role       # ì‚¬ìš©ì ì—­í•  ë³€ê²½
POST   /api/admin/refunds/emergency   # ê¸´ê¸‰ í™˜ë¶ˆ
```

---

## í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ common/                    # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ events/                    # ì´ë²¤íŠ¸ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ tickets/                   # í‹°ì¼“ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ marketplace/               # ì¬íŒë§¤ ë§ˆì¼“í”Œë ˆì´ìŠ¤
â”‚   â”‚   â””â”€â”€ admin/                     # ê´€ë¦¬ì í˜ì´ì§€
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Home.tsx
â”‚   â”‚   â”œâ”€â”€ Events.tsx
â”‚   â”‚   â”œâ”€â”€ EventDetail.tsx
â”‚   â”‚   â”œâ”€â”€ MyTickets.tsx
â”‚   â”‚   â”œâ”€â”€ Marketplace.tsx
â”‚   â”‚   â”œâ”€â”€ CreateEvent.tsx
â”‚   â”‚   â””â”€â”€ Admin.tsx
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useWeb3.ts                 # Web3 ì—°ê²°
â”‚   â”‚   â”œâ”€â”€ useAccountAbstraction.ts   # Account Abstraction
â”‚   â”‚   â”œâ”€â”€ useEvents.ts
â”‚   â”‚   â””â”€â”€ useTickets.ts
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api.ts                     # API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ web3.ts                    # Web3 ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ ipfs.ts                    # IPFS ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â”œâ”€â”€ authStore.ts               # ì¸ì¦ ìƒíƒœ
â”‚   â”‚   â”œâ”€â”€ eventStore.ts
â”‚   â”‚   â””â”€â”€ ticketStore.ts
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ constants.ts               # ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ ë“±
â”‚       â””â”€â”€ helpers.ts
```

---

## Account Abstraction êµ¬í˜„

### êµ¬ì¡°

```
User (ì†Œì…œ ë¡œê·¸ì¸)
    â†“
Backend (FastAPI)
    â”œâ”€â”€ ì‚¬ìš©ì ì¸ì¦ (JWT)
    â”œâ”€â”€ Smart Wallet ìƒì„±/ê´€ë¦¬
    â””â”€â”€ UserOperation ìƒì„±
    â†“
Bundler (Alchemy/Stackup)
    â”œâ”€â”€ UserOperation ê²€ì¦
    â”œâ”€â”€ ê°€ìŠ¤ë¹„ ê³„ì‚°
    â””â”€â”€ íŠ¸ëœì­ì…˜ ë²ˆë“¤ë§
    â†“
Paymaster (ìì²´ êµ¬í˜„)
    â”œâ”€â”€ ê°€ìŠ¤ë¹„ ì§€ë¶ˆ (í•µì‹¬ ê¸°ëŠ¥ë§Œ)
    â””â”€â”€ ì •ì±… ê²€ì¦
    â†“
EntryPoint (ERC-4337)
    â””â”€â”€ íŠ¸ëœì­ì…˜ ì‹¤í–‰
    â†“
Polygon Blockchain
```

### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

1. **Smart Wallet ìƒì„±**
   - ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œ ë°±ì—”ë“œì—ì„œ Smart Wallet ì£¼ì†Œ ìƒì„±
   - Deterministic ì£¼ì†Œ ìƒì„± (CREATE2 ì‚¬ìš©)
   - ì‚¬ìš©ìë³„ ê³ ìœ  Smart Wallet

2. **UserOperation ìƒì„±**
   - í”„ë¡ íŠ¸ì—”ë“œì—ì„œ íŠ¸ëœì­ì…˜ ìš”ì²­
   - ë°±ì—”ë“œê°€ UserOperation ìƒì„±
   - ì„œëª…ì€ ë°±ì—”ë“œì—ì„œ ê´€ë¦¬ (ë³´ì•ˆ ê³ ë ¤ í•„ìš”)

3. **Paymaster ì •ì±…**
   - í‹°ì¼“ êµ¬ë§¤: ì„œë¹„ìŠ¤ ë¶€ë‹´
   - ì¬íŒë§¤ êµ¬ë§¤: ì‚¬ìš©ì ë¶€ë‹´
   - í™˜ë¶ˆ: ì„œë¹„ìŠ¤ ë¶€ë‹´
   - ì¬íŒë§¤ ë“±ë¡: ì‚¬ìš©ì ë¶€ë‹´

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- Smart Wallet ì„œëª… í‚¤ëŠ” ì•”í˜¸í™”í•˜ì—¬ ì €ì¥
- í•˜ë“œì›¨ì–´ ì§€ê°‘ ë˜ëŠ” AWS KMS ì‚¬ìš© ê³ ë ¤
- Rate limiting ë° íŠ¸ëœì­ì…˜ ê²€ì¦

---

## IPFS í†µí•©

### Pinata ì‚¬ìš©

1. **ì´ë²¤íŠ¸ ë©”íƒ€ë°ì´í„° êµ¬ì¡°**
```json
{
  "name": "ì½˜ì„œíŠ¸ ì´ë¦„",
  "description": "ì´ë²¤íŠ¸ ì„¤ëª…",
  "image": "ipfs://Qm...", // ì´ë²¤íŠ¸ ì´ë¯¸ì§€
  "attributes": [
    {
      "trait_type": "Date",
      "value": "2024-12-25"
    },
    {
      "trait_type": "Venue",
      "value": "ì˜¬ë¦¼í”½ê³µì›"
    }
  ]
}
```

2. **í‹°ì¼“ ë©”íƒ€ë°ì´í„° êµ¬ì¡°**
```json
{
  "name": "Ticket #123",
  "description": "ì½˜ì„œíŠ¸ í‹°ì¼“",
  "image": "ipfs://Qm...", // í‹°ì¼“ ì´ë¯¸ì§€
  "attributes": [
    {
      "trait_type": "Event",
      "value": "ì´ë²¤íŠ¸ ID"
    },
    {
      "trait_type": "Seat",
      "value": "A-12"
    }
  ]
}
```

3. **ì—…ë¡œë“œ í”„ë¡œì„¸ìŠ¤**
   - ë°±ì—”ë“œì—ì„œ Pinata API ì‚¬ìš©
   - ë©”íƒ€ë°ì´í„° JSON ìƒì„±
   - IPFSì— ì—…ë¡œë“œ
   - í•´ì‹œë¥¼ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì— ì €ì¥

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸
- Reentrancy ë°©ì§€
- Access Control ê²€ì¦
- Integer overflow ë°©ì§€ (Solidity 0.8+)
- ì´ë²¤íŠ¸ ë¡œê¹…
- ì™¸ë¶€ ê°ì‚¬ ê¶Œì¥

### ë°±ì—”ë“œ
- JWT í† í° ê²€ì¦
- Rate limiting
- SQL Injection ë°©ì§€ (ORM ì‚¬ìš©)
- CORS ì„¤ì •
- í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬ (.env)

### í”„ë¡ íŠ¸ì—”ë“œ
- XSS ë°©ì§€
- CSRF í† í°
- ì…ë ¥ ê²€ì¦
- ë¯¼ê° ì •ë³´ ë…¸ì¶œ ë°©ì§€

### Account Abstraction
- Smart Wallet í‚¤ ê´€ë¦¬
- UserOperation ê²€ì¦
- Paymaster ì •ì±… ì—„ê²©íˆ ì ìš©

---

## ë°°í¬ ì „ëµ

### ê°œë°œ í™˜ê²½
- ë¡œì»¬ Hardhat ë„¤íŠ¸ì›Œí¬
- ë¡œì»¬ PostgreSQL
- Pinata í…ŒìŠ¤íŠ¸ ê³„ì •

### í…ŒìŠ¤íŠ¸ë„· ë°°í¬
1. **ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸**
   - Hardhatë¡œ Polygon Mumbai í…ŒìŠ¤íŠ¸ë„· ë°°í¬
   - ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ ì €ì¥

2. **ë°±ì—”ë“œ**
   - Docker ì»¨í…Œì´ë„ˆë¡œ ë°°í¬
   - í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

3. **í”„ë¡ íŠ¸ì—”ë“œ**
   - Vercel / Netlify ë°°í¬
   - í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### ë©”ì¸ë„· ë°°í¬
- ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì™¸ë¶€ ê°ì‚¬ í•„ìˆ˜
- ì ì§„ì  ë¡¤ì•„ì›ƒ
- ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•

---

## ë‹¤ìŒ ë‹¨ê³„

1. í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •
2. ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ê°œë°œ
3. ë°±ì—”ë“œ API ê°œë°œ
4. í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ
5. í†µí•© í…ŒìŠ¤íŠ¸
6. í…ŒìŠ¤íŠ¸ë„· ë°°í¬
7. ë³´ì•ˆ ê°ì‚¬
8. ë©”ì¸ë„· ë°°í¬

---

## ì°¸ê³  ìë£Œ

- [ERC-721 í‘œì¤€](https://eips.ethereum.org/EIPS/eip-721)
- [ERC-4337 (Account Abstraction)](https://eips.ethereum.org/EIPS/eip-4337)
- [Polygon ë¬¸ì„œ](https://docs.polygon.technology/)
- [Hardhat ë¬¸ì„œ](https://hardhat.org/docs)
- [FastAPI ë¬¸ì„œ](https://fastapi.tiangolo.com/)
- [Pinata ë¬¸ì„œ](https://docs.pinata.cloud/)

